{% extends 'base.html' %}
{% block title %}Statistics{% endblock %}
{% block dashboard_name %}Statistics{% endblock %}
{% block body %}

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="card shadow-lg border-0 rounded-4">
                <div class="card-body p-5">
                    <h2 class="text-center mb-4 text-primary">Statistics</h2>
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Plan</th>
                                <th>Situation</th>
                                <th>Email</th>
                                <th>Phone</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for client in Clients %}
                            <tr id="{{ client.id }}">
                                <td>{{ client.name }}</td>
                                <td>{{ client.plan_id }}</td>
                                <td>{{ client.active }}</td>
                                <td>{{ client.email }}</td>
                                <td>{{ client.phone }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <br>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const rows = document.querySelectorAll("tbody tr");
    rows.forEach(row => {
        row.addEventListener("click", function() {
            const clientId = this.id;
            fetch('/checkins/' + clientId, {  // <-- observe a barra final
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
            });
        });
    });
});

</script>

{% endblock %}